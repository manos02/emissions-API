openapi: '3.0.2'
info:
  title: CO2 Emissions API.
  version: '1.0'
  description: |
    Design API for a web application used to see and update a database related to CO2
    and greenhouose gases emissions.

servers:
  - url: http://localhost:51417
    description: Spring Boot backend implementation.

components:
  schemas:
    $ref: "schemas.yaml"

  responses:
    $ref: "reponses.yaml"

  parameters:
    order:
      name: order
      in: query
      required: false
      description:  Whether the data is ascending or descending
      schema:
        $ref: "#/components/schemas/CountryFilterKeysAlpha"


    filter:
      name: filter
      in: query
      required: false
      description: The column to order the result data by numbers
      schema:
        $ref: "#/components/schemas/CountryFilterKeysIsoName"


    limit:
      name: limit
      in: query
      required: false
      description: Limit the number of returned items
      schema:
        type: integer
        maximum: 100

    offset:
      name: offset
      in: query
      required: false
      description: The number of items to skip before returning {limit} items
      schema:
        type: integer
        
    lower:
      name: lower
      in: query
      required: false
      description: The lower bound 
      schema:
        type: integer

    upper:
      name: upper
      in: query
      required: false
      description: The upper bound
      schema:
        type: integer
    
    dataType:
      name: dataType
      in: query
      required: false
      description: The type of data to be displayed
      schema:
        type: integer
        maximum: 4
        minimum: 0

paths:
  /countries:
    get:
      tags:
        - Countries
      summary: Retrives a list of countries.
      description: Retrieves a list of countries (their name and ISO code).
      parameters:
        - $ref: "#/components/parameters/order"
        - $ref: "#/components/parameters/filter"
        - $ref: "#/components/parameters/limit"
        - $ref: "#/components/parameters/offset"
      
      responses:
        "200":
          description: Successful retrieval
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/SummaryData"
            text/csv:
              schema:
                $ref: "#components/schemas/SummaryData"
              example: |-
                name,data/0/year,data/0/emissionData/co2,data/0/emissionData/ch4,data/0/emissionData/n20,data/0/emissionData/ghg,data/0/emissionData/year,data/0/energyData/energy_per_cap,data/0/energyData/energy_per_ghg,data/0/energyData/year,data/0/generalData/population,data/0/generalData/gdp,data/0/generalData/year,data/0/temperatureData/shares,data/0/temperatureData/change_ch4,data/0/temperatureData/change_n20,data/0/temperatureData/change_co2,data/0/temperatureData/change_ghg,data/0/temperatureData/year,iso
                string,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,string

        '204':
          $ref: "#/components/responses/NoResults"

        '400':
          $ref: '#/components/responses/BadRequest'

        '5XX':
          $ref: '#/components/responses/ServerError'

  /countries/{ISO}:

    get:
      tags:
        - Countries
      summary: Retrives the summary of a country.
      description: Retrieves the summary of a specific country and some data. The country is picked based on ISO code.
      parameters: 
        - name: ISO
          in: path
          required: true
          description: ISO of the country
          schema:
            type: string
        - $ref: "#/components/parameters/limit"
        - $ref: "#/components/parameters/offset"
        - $ref: "#/components/parameters/order"
        - $ref: "#/components/parameters/lower"
        - $ref: "#/components/parameters/upper"
        - $ref: "#/components/parameters/dataType"
      responses:
        "200":
          description: Successful retrieval
          content:
            application/json:
              schema:
                $ref : "#components/schemas/SummaryData"
            text/csv:
              schema:
                $ref: "#components/schemas/SummaryData"
              example: |-
                year,emissionData/co2,emissionData/ch4,emissionData/n20,emissionData/ghg,emissionData/year,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/year,generalData/population,generalData/gdp,generalData/year,temperatureData/shares,temperatureData/change_ch4,temperatureData/change_n20,temperatureData/change_co2,temperatureData/change_ghg,temperatureData/year
                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0


        '204':
          $ref: "#/components/responses/NoResults"

        '400':
          $ref: '#/components/responses/BadRequest'

        '5XX':
          $ref: '#/components/responses/ServerError'

    post:
      tags:
        - Countries
      summary: Creates the data for a country in a specific year.
      description: Creates the data for a country in a specific year, aditionally filtered by dataType.
      parameters: 
        - name: ISO
          in: path
          required: true
          description: ISO of the country
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GeneralData"
      responses:
        '201':
          description: Country data successfully created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Data"
                description: The year of the newly created data.
            text/csv:
              schema:
                type: integer
                example: |-
                  year,generalData/population,generalData/GDP,generalData/ownerName,emissionData/CO2,emissionData/CH4,emissionData/N20,emissionData/total_ghg,emissionData/ownerName,temperatureData/shares_of_temp_change_from_ghg,temperatureData/temperature_change_CH4,temperatureData/temperature_change_N20,temperatureData/temperature_change_CO2,temperatureData/temperature_change_ghg,temperatureData/ownerName,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/ownerName
                  0,0,0,string,0,0,0,0,string,0,0,0,0,0,string,0,0,string
          
  /countries/{ISO}/{year}:
    parameters:
      - name: ISO
        in: path
        required: true
        description: ISO of the country.
        schema:
          type: string
      - name: year
        in: path
        required: true
        description: Year of the data.
        schema:
          type: integer
      
    get:
      tags:
        - Countries
      summary: Retrieves the date for a country in a specific year.
      description: Retrieves the data for a country in a specific year, aditionally filtered by dataType.
      parameters:
        - $ref: "#/components/parameters/dataType"
      responses:
        '200':
          description: Successful retrieval
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Data"

            text/csv:
              schema:
                $ref: "#components/schemas/Data"
              example: |-
                year,emissionData/co2,emissionData/ch4,emissionData/n20,emissionData/ghg,emissionData/year,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/year,generalData/population,generalData/gdp,generalData/year,temperatureData/shares,temperatureData/change_ch4,temperatureData/change_n20,temperatureData/change_co2,temperatureData/change_ghg,temperatureData/year
                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0


        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref:  "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

    put:
      tags:
        - Countries
      summary: Updates the data for a country in a specific year.
      description: Updates the data for a country in a specific year, aditionally filtered by dataType.
      parameters:
        - $ref: "#/components/parameters/dataType"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Data"
          text/csv:
            schema:
              $ref: "#/components/schemas/Data"
            example: |-
              year,emissionData/co2,emissionData/ch4,emissionData/n20,emissionData/ghg,emissionData/year,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/year,generalData/population,generalData/gdp,generalData/year,temperatureData/shares,temperatureData/change_ch4,temperatureData/change_n20,temperatureData/change_co2,temperatureData/change_ghg,temperatureData/year
              0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0

      responses:
        '200':
          description: Country updated, returns the new state
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Data"
            text/csv:
              schema:
                $ref: "#/components/schemas/Data"
              example: |-
                year,emissionData/co2,emissionData/ch4,emissionData/n20,emissionData/ghg,emissionData/year,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/year,generalData/population,generalData/gdp,generalData/year,temperatureData/shares,temperatureData/change_ch4,temperatureData/change_n20,temperatureData/change_co2,temperatureData/change_ghg,temperatureData/year
                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0

        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref: "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

    delete:
      tags:
        - Countries
      summary: Deletes data for a country.
      description: Deletes  data for a country in a specific year.
      
      responses:
        '204':
          description: "Deleted data for a country"
          
        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref: "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

  

  /countries/year{year}:
    parameters:
      - name: year
        in: path
        required: true
        description: Year of the data.
        schema:
          type: integer
      - $ref: "#/components/parameters/limit"
      - $ref: "#/components/parameters/offset"
      - $ref: "#/components/parameters/order"
      - $ref: "#/components/parameters/lower"
      - $ref: "#/components/parameters/upper"
      - $ref: "#/components/parameters/dataType"
    get:
      tags:
        - Countries
      summary: Retrieves all the data in a year.
      description: Retrives all the data in a specific year, aditionally filtered by dataType.
      responses:
        '200':
          description: Successful retrieval
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/SummaryData"
            text/csv:
              schema:
                $ref: "#components/schemas/SummaryData"
              example: |-
                name,data/0/year,data/0/emissionData/co2,data/0/emissionData/ch4,data/0/emissionData/n20,data/0/emissionData/ghg,data/0/emissionData/year,data/0/energyData/energy_per_cap,data/0/energyData/energy_per_ghg,data/0/energyData/year,data/0/generalData/population,data/0/generalData/gdp,data/0/generalData/year,data/0/temperatureData/shares,data/0/temperatureData/change_ch4,data/0/temperatureData/change_n20,data/0/temperatureData/change_co2,data/0/temperatureData/change_ghg,data/0/temperatureData/year,iso
                string,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,string

        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref:  "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

  /continents:
    get:
      tags:
        - Continents
      summary: Retrieves a list of continents
      description: Retrieves a list of continents with their name and data
      parameters:
          - $ref: "#/components/parameters/order"
          - $ref: "#/components/parameters/limit"
          - $ref: "#/components/parameters/offset"

      responses:
        '200':
          description: successful retrieval of continents
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
            text/csv:
              schema:
                type: array
                items:
                  type: string
              example: |-
                Field1
                string
        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref:  "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

  /continents/{name}:
    get:
      tags:
        - Continents
      summary: "Retrieves a continent"
      description: "Retrieves a continent with specified name"
      parameters:
          - name: name
            in: path
            required: true
            description: Name of the continent.
            schema:
              type: string
              
          - $ref: "#/components/parameters/limit"
          - $ref: "#/components/parameters/offset"
          - $ref: "#/components/parameters/order"
          - $ref: "#/components/parameters/lower"
          - $ref: "#/components/parameters/upper"
          - $ref: "#/components/parameters/dataType"
      responses:
        '200':
          description: Successful retrieval
          content:
            application/json:
              schema:
                  $ref: "#/components/schemas/SummaryData"
            text/csv:
              schema:
                 $ref: "#/components/schemas/SummaryData"
              example: |-
                year,emissionData/co2,emissionData/ch4,emissionData/n20,emissionData/ghg,emissionData/year,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/year,generalData/population,generalData/gdp,generalData/year,temperatureData/shares,temperatureData/change_ch4,temperatureData/change_n20,temperatureData/change_co2,temperatureData/change_ghg,temperatureData/year
                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
                
        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref:  "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

    post:
      tags:
        - Continents
      summary: Creates Data for a continent.
      description: Creates any kind of Data for a continent (based on name) in a specific year.
      parameters:
        - name: name
          in: path
          required: true
          description: Name of the continent.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: integer
      responses:
        '200':
          description: Successfull creation, returns the new state
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Data"
            text/csv:
              schema:
                $ref: "#/components/schemas/Data"
              example: |-
                year,emissionData/co2,emissionData/ch4,emissionData/n20,emissionData/ghg,emissionData/year,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/year,generalData/population,generalData/gdp,generalData/year,temperatureData/shares,temperatureData/change_ch4,temperatureData/change_n20,temperatureData/change_co2,temperatureData/change_ghg,temperatureData/year
                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
                
        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref: "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

  /continents/{name}/{year}:
    parameters:
      - name: year
        in: path
        required: true
        description: Year of the data.
        schema:
          type: integer
      - name: name
        in: path
        required: true
        description: Name of the continent.
        schema:
          type: string
  
    get:
      tags:
        - Continents
      summary: "Retrieves a continent"
      description: "Retrieves a continent with specified name"
      parameters:
        - $ref: "#/components/parameters/dataType"
      responses:
        '200':
          description: Successful retrieval
          content:
            application/json:
              schema:
                  $ref: "#/components/schemas/Data"
            text/csv:
              schema:
                 $ref: "#/components/schemas/Data"
              example: |-
                year,emissionData/co2,emissionData/ch4,emissionData/n20,emissionData/ghg,emissionData/year,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/year,generalData/population,generalData/gdp,generalData/year,temperatureData/shares,temperatureData/change_ch4,temperatureData/change_n20,temperatureData/change_co2,temperatureData/change_ghg,temperatureData/year
                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0

        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref:  "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'
    
    put:
      tags:
        - Continents
      summary: Updates Data for a continent.
      description: Updates any kind of Data for a continent (based on name) in a specific year.
      parameters:
        - $ref: "#/components/parameters/dataType"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Data"
      responses:
        '200':
          description: Country updated, returns the new state
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Data"
            text/csv:
              schema:
                $ref: "#/components/schemas/Data"
              example: |-
                year,generalData/population,generalData/GDP,generalData/ownerName,emissionData/CO2,emissionData/CH4,emissionData/N20,emissionData/total_ghg,emissionData/ownerName,temperatureData/shares_of_temp_change_from_ghg,temperatureData/temperature_change_CH4,temperatureData/temperature_change_N20,temperatureData/temperature_change_CO2,temperatureData/temperature_change_ghg,temperatureData/ownerName,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/ownerName
                0,0,0,string,0,0,0,0,string,0,0,0,0,0,string,0,0,string

        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref: "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'


    delete:
      tags:
        - Continents
      summary: Deletes Data for a continent.
      description: Deletes any kind of Data for a continent (based on name) in a specific year.
      responses:
        '200':
          description: Successful deletion of data

        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref: "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

  /continents/year{year}:
    get:
      tags:
        - Continents
      summary: Retrieves all continents data
      description: Retrieves all data for continents in a specific year
      parameters:
        - name: year
          in: path
          required: true
          description: Year of the data.
          schema:
            type: integer
        - $ref: "#/components/parameters/limit"
        - $ref: "#/components/parameters/offset"
        - $ref: "#/components/parameters/order"
        - $ref: "#/components/parameters/lower"
        - $ref: "#/components/parameters/upper"
        - $ref: "#/components/parameters/dataType"
      responses:
        '200':
          description: Successful retrieval
          content:
            application/json:
              schema:
                  type: array
                  items:
                    $ref: "#/components/schemas/SummaryData"
            text/csv:
              schema:
                 $ref: "#/components/schemas/SummaryData"
              example: |-
                name,data/0/year,data/0/emissionData/co2,data/0/emissionData/ch4,data/0/emissionData/n20,data/0/emissionData/ghg,data/0/emissionData/year,data/0/energyData/energy_per_cap,data/0/energyData/energy_per_ghg,data/0/energyData/year,data/0/generalData/population,data/0/generalData/gdp,data/0/generalData/year,data/0/temperatureData/shares,data/0/temperatureData/change_ch4,data/0/temperatureData/change_n20,data/0/temperatureData/change_co2,data/0/temperatureData/change_ghg,data/0/temperatureData/year,iso
                string,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,string


        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref:  "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'