openapi: '3.0.2'
info:
  title: CO2 Emissions API.
  version: '1.0'
  description: |
    Design API for a web application used to see and update a database related to CO2
    and greenhouose gases emissions.

servers:
  - url: http://localhost:8080
    description: Spring Boot backend implementation.

components:
  schemas:
    $ref: "schemas.yaml"

  responses:
    $ref: "reponses.yaml"

  parameters:
    order-by-alpha:
      name: order-by-alpha
      in: query
      required: false
      description: The column to order the result data by alphabetically
      schema:
        $ref: "#/components/schemas/CountryFilterKeysAlpha"


    order-by-num:
      name: order-by-num
      in: query
      required: false
      description: The column to order the result data by numbers
      schema:
        $ref: "#/components/schemas/CountryFilterKeysNum"

    order-dir:
      name: order-dir
      in: query
      required: false
      description: The directorion to order the indicated column
      schema:
        type: string
        enum:
          - desc
          - asc

    limit:
      name: limit
      in: query
      required: false
      description: Limit the number of returned items
      schema:
        type: integer
        maximum: 100

    offset:
      name: offset
      in: query
      required: false
      description: The number of items to skip before returning {limit} items
      schema:
        type: integer
        
    lower-bound:
      name: lower-bound
      in: query
      required: false
      description: The lower bound in years
      schema:
        type: integer

    upper-bound:
      name: upper-bound
      in: query
      required: false
      description: The upper bound in years
      schema:
        type: integer
    
    data-type:
      name: data-type
      in: query
      required: false
      description: The type of data to be displayed
      schema:
        type: integer
        maximum: 4
        minimum: 0

paths:
  /countries:
    get:
      tags:
        - Countries
      summary: Retrives a list of countries.
      description: Retrieves a list of countries (their name and ISO code).
      parameters:
        - $ref: "#/components/parameters/order-by-alpha"
        - $ref: "#/components/parameters/order-dir"
        - $ref: "#/components/parameters/limit"
        - $ref: "#/components/parameters/offset"
      
      responses:
        "200":
          description: Successful retrieval
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/CountrySummary"
            text/csv:
              schema:
                $ref: "#components/schemas/CountrySummary"
              example: |-
                name,ISO
                string,string 

        '204':
          $ref: "#/components/responses/NoResults"

        '400':
          $ref: '#/components/responses/BadRequest'

        '5XX':
          $ref: '#/components/responses/ServerError'

  /countries/{ISO}:
    parameters: 
      - name: ISO
        in: path
        required: true
        description: ISO of the country
        schema:
          type: string
      - $ref: "#/components/parameters/limit"
      - $ref: "#/components/parameters/offset"
      - $ref: "#/components/parameters/order-dir"
      - $ref: "#/components/parameters/lower-bound"
      - $ref: "#/components/parameters/upper-bound"
      - $ref: "#/components/parameters/data-type"
    get:
      tags:
        - Countries
      summary: Retrives the summary of a country.
      description: Retrieves the summary of a specific country and some data. The country is picked based on ISO code.
      responses:
        "200":
          description: Successful retrieval
          content:
            application/json:
              schema:
                $ref : "#components/schemas/Country"
            text/csv:
              schema:
                $ref: "#components/schemas/Country"
              example: |-
                year,generalData/population,generalData/GDP,generalData/ownerName,emissionData/CO2,emissionData/CH4,emissionData/N20,emissionData/total_ghg,emissionData/ownerName,temperatureData/shares_of_temp_change_from_ghg,temperatureData/temperature_change_CH4,temperatureData/temperature_change_N20,temperatureData/temperature_change_CO2,temperatureData/temperature_change_ghg,temperatureData/ownerName,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/ownerName
                0,0,0,string,0,0,0,0,string,0,0,0,0,0,string,0,0,string


        '204':
          $ref: "#/components/responses/NoResults"

        '400':
          $ref: '#/components/responses/BadRequest'

        '5XX':
          $ref: '#/components/responses/ServerError'
          
  /countries/{ISO}/{year}:
    parameters:
      - name: ISO
        in: path
        required: true
        description: ISO of the country.
        schema:
          type: string
      - name: year
        in: path
        required: true
        description: Year of the data.
        schema:
          type: integer
      - $ref: "#/components/parameters/data-type"
      
    get:
      tags:
        - Countries
      summary: Retrives the date for a country in a specific year.
      description: Retrives the data for a country in a specific year, aditionally filtered by dataType.
      responses:
        '200':
          description: Successful retrieval
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Data"

            text/csv:
              schema:
                $ref: "#components/schemas/Data"
              example: |-
                year,generalData/population,generalData/GDP,generalData/ownerName,emissionData/CO2,emissionData/CH4,emissionData/N20,emissionData/total_ghg,emissionData/ownerName,temperatureData/shares_of_temp_change_from_ghg,temperatureData/temperature_change_CH4,temperatureData/temperature_change_N20,temperatureData/temperature_change_CO2,temperatureData/temperature_change_ghg,temperatureData/ownerName,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/ownerName
                0,0,0,string,0,0,0,0,string,0,0,0,0,0,string,0,0,string
        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref:  "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

    put:
      tags:
        - Countries
      summary: Updates the date for a country in a specific year.
      description: Updates the data for a country in a specific year, aditionally filtered by dataType.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Data"
          text/csv:
            schema:
              $ref: "#/components/schemas/Data"
            example: |-
              year,generalData/population,generalData/GDP,generalData/ownerName,emissionData/CO2,emissionData/CH4,emissionData/N20,emissionData/total_ghg,emissionData/ownerName,temperatureData/shares_of_temp_change_from_ghg,temperatureData/temperature_change_CH4,temperatureData/temperature_change_N20,temperatureData/temperature_change_CO2,temperatureData/temperature_change_ghg,temperatureData/ownerName,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/ownerName
              0,0,0,string,0,0,0,0,string,0,0,0,0,0,string,0,0,string
      responses:
        '200':
          description: Country updated, returns the new state
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Data"
            text/csv:
              schema:
                $ref: "#/components/schemas/Data"
              example: |-
                year,generalData/population,generalData/GDP,generalData/ownerName,emissionData/CO2,emissionData/CH4,emissionData/N20,emissionData/total_ghg,emissionData/ownerName,temperatureData/shares_of_temp_change_from_ghg,temperatureData/temperature_change_CH4,temperatureData/temperature_change_N20,temperatureData/temperature_change_CO2,temperatureData/temperature_change_ghg,temperatureData/ownerName,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/ownerName
                0,0,0,string,0,0,0,0,string,0,0,0,0,0,string,0,0,string


        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref: "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

    delete:
      tags:
        - Countries
      summary: Deletes the date for a country in a specific year.
      description: Deletes the data for a country in a specific year, aditionally filtered by dataType.
      
      responses:
        '204':
          description: "Deleted data for a country"
          
        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref: "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

    post:
        tags:
          - Countries
        summary: Creates the date for a country in a specific year.
        description: Creates the data for a country in a specific year, aditionally filtered by dataType.
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Data"
        responses:
          '201':
            description: Country data successfully created
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/Data"
                  description: The year of the newly created data.
              text/csv:
                schema:
                  type: integer
                  example: |-
                    year,generalData/population,generalData/GDP,generalData/ownerName,emissionData/CO2,emissionData/CH4,emissionData/N20,emissionData/total_ghg,emissionData/ownerName,temperatureData/shares_of_temp_change_from_ghg,temperatureData/temperature_change_CH4,temperatureData/temperature_change_N20,temperatureData/temperature_change_CO2,temperatureData/temperature_change_ghg,temperatureData/ownerName,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/ownerName
                    0,0,0,string,0,0,0,0,string,0,0,0,0,0,string,0,0,string

  /countries/year{year}:
    parameters:
      - name: year
        in: path
        required: true
        description: Year of the data.
        schema:
          type: integer
      - $ref: "#/components/parameters/limit"
      - $ref: "#/components/parameters/offset"
      - $ref: "#/components/parameters/order-dir"
      - $ref: "#/components/parameters/lower-bound"
      - $ref: "#/components/parameters/upper-bound"
      - $ref: "#/components/parameters/data-type"
    get:
      tags:
        - Countries
      summary: Retrieves all the data in a year.
      description: Retrives all the data in a specific year, aditionally filtered by data-type.
      responses:
        '200':
          description: Successful retrieval
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Data"

            text/csv:
              schema:
                $ref: "#components/schemas/Data"
              example: |-
                year,generalData/population,generalData/GDP,generalData/ownerName,emissionData/CO2,emissionData/CH4,emissionData/N20,emissionData/total_ghg,emissionData/ownerName,temperatureData/shares_of_temp_change_from_ghg,temperatureData/temperature_change_CH4,temperatureData/temperature_change_N20,temperatureData/temperature_change_CO2,temperatureData/temperature_change_ghg,temperatureData/ownerName,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/ownerName
                0,0,0,string,0,0,0,0,string,0,0,0,0,0,string,0,0,string
               

        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref:  "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

  /continents:
    get:
      tags:
        - Continents
      summary: Retrieves a list of continents
      description: Retrieves a list of continents with their name and data
      parameters:
          - $ref: "#/components/parameters/order-dir"
          - $ref: "#/components/parameters/limit"
          - $ref: "#/components/parameters/offset"

      responses:
        '200':
          description: successful retrieval of continents
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ContinentSummary"
            text/csv:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ContinentSummary"
              example: |-
                name
                string
        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref:  "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

  /continents/{name}:
    get:
      tags:
        - Continents
      summary: "Retrieves a continent"
      description: "Retrieves a continent with specified name"
      parameters:
          - name: name
            in: path
            required: true
            description: Name of the continent.
            schema:
              type: string
              
          - $ref: "#/components/parameters/limit"
          - $ref: "#/components/parameters/offset"
          - $ref: "#/components/parameters/order-dir"
          - $ref: "#/components/parameters/lower-bound"
          - $ref: "#/components/parameters/upper-bound"
          - $ref: "#/components/parameters/data-type"
      responses:
        '200':
          description: Successful retrieval
          content:
            application/json:
              schema:
                  $ref: "#/components/schemas/Data"
            text/csv:
              schema:
                 $ref: "#/components/schemas/Data"
              example: |-
                year,generalData/population,generalData/GDP,generalData/ownerName,emissionData/CO2,emissionData/CH4,emissionData/N20,emissionData/total_ghg,emissionData/ownerName,temperatureData/shares_of_temp_change_from_ghg,temperatureData/temperature_change_CH4,temperatureData/temperature_change_N20,temperatureData/temperature_change_CO2,temperatureData/temperature_change_ghg,temperatureData/ownerName,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/ownerName
                0,0,0,string,0,0,0,0,string,0,0,0,0,0,string,0,0,string
                

        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref:  "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

  /continents/{name}/year{year}:
    parameters:
      - name: year
        in: path
        required: true
        description: Year of the data.
        schema:
          type: integer
      - name: name
        in: path
        required: true
        description: Name of the continent.
        schema:
          type: string
      - $ref: "#/components/parameters/data-type"
    get:
      tags:
        - Continents
      summary: "Retrieves a continent"
      description: "Retrieves a continent with specified name"
      responses:
        '200':
          description: Successful retrieval
          content:
            application/json:
              schema:
                  $ref: "#/components/schemas/Data"
            text/csv:
              schema:
                 $ref: "#/components/schemas/Data"
              example: |-
                year,generalData/population,generalData/GDP,generalData/ownerName,emissionData/CO2,emissionData/CH4,emissionData/N20,emissionData/total_ghg,emissionData/ownerName,temperatureData/shares_of_temp_change_from_ghg,temperatureData/temperature_change_CH4,temperatureData/temperature_change_N20,temperatureData/temperature_change_CO2,temperatureData/temperature_change_ghg,temperatureData/ownerName,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/ownerName
                0,0,0,string,0,0,0,0,string,0,0,0,0,0,string,0,0,string
                

        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref:  "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'
    
    put:
      tags:
        - Continents
      summary: Updates Data for a continent.
      description: Updates any kind of Data for a continent (based on name) in a specific year.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Data"
      responses:
        '200':
          description: Country updated, returns the new state
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Data"
            text/csv:
              schema:
                $ref: "#/components/schemas/Data"
              example: |-
                year,generalData/population,generalData/GDP,generalData/ownerName,emissionData/CO2,emissionData/CH4,emissionData/N20,emissionData/total_ghg,emissionData/ownerName,temperatureData/shares_of_temp_change_from_ghg,temperatureData/temperature_change_CH4,temperatureData/temperature_change_N20,temperatureData/temperature_change_CO2,temperatureData/temperature_change_ghg,temperatureData/ownerName,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/ownerName
                0,0,0,string,0,0,0,0,string,0,0,0,0,0,string,0,0,string

        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref: "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

    post:
      tags:
        - Continents
      summary: Creates Data for a continent.
      description: Creates any kind of Data for a continent (based on name) in a specific year.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Data"
      responses:
        '200':
          description: Successfull creation, returns the new state
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Data"
            text/csv:
              schema:
                $ref: "#/components/schemas/Data"
              example: |-
                year,generalData/population,generalData/GDP,generalData/ownerName,emissionData/CO2,emissionData/CH4,emissionData/N20,emissionData/total_ghg,emissionData/ownerName,temperatureData/shares_of_temp_change_from_ghg,temperatureData/temperature_change_CH4,temperatureData/temperature_change_N20,temperatureData/temperature_change_CO2,temperatureData/temperature_change_ghg,temperatureData/ownerName,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/ownerName
                0,0,0,string,0,0,0,0,string,0,0,0,0,0,string,0,0,string
                
        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref: "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

    delete:
      tags:
        - Continents
      summary: Deletes Data for a continent.
      description: Deletes any kind of Data for a continent (based on name) in a specific year.
      responses:
        '200':
          description: Successful deletion of data

        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref: "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'

  /continents/year{year}:
    get:
      tags:
        - Continents
      summary: Retrieves all continents data
      description: Retrieves all data for continents in a specific year
      parameters:
        - name: year
          in: path
          required: true
          description: Year of the data.
          schema:
            type: integer
        - $ref: "#/components/parameters/limit"
        - $ref: "#/components/parameters/offset"
        - $ref: "#/components/parameters/order-dir"
        - $ref: "#/components/parameters/lower-bound"
        - $ref: "#/components/parameters/upper-bound"
        - $ref: "#/components/parameters/data-type"
      responses:
        '200':
          description: Successful retrieval
          content:
            application/json:
              schema:
                  $ref: "#/components/schemas/Data"
            text/csv:
              schema:
                 $ref: "#/components/schemas/Data"
              example: |-
                year,generalData/population,generalData/GDP,generalData/ownerName,emissionData/CO2,emissionData/CH4,emissionData/N20,emissionData/total_ghg,emissionData/ownerName,temperatureData/shares_of_temp_change_from_ghg,temperatureData/temperature_change_CH4,temperatureData/temperature_change_N20,temperatureData/temperature_change_CO2,temperatureData/temperature_change_ghg,temperatureData/ownerName,energyData/energy_per_cap,energyData/energy_per_ghg,energyData/ownerName
                0,0,0,string,0,0,0,0,string,0,0,0,0,0,string,0,0,string


        '400':
          $ref: '#/components/responses/BadRequest'

        '404':
          $ref:  "#/components/responses/NotFound"

        '5XX':
          $ref: '#/components/responses/ServerError'